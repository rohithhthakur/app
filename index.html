import pandas as pd

class ConaFileGenerator:
    def __init__(self, summary_file_path, new_cona=False, columns_to_remove=None):
        self.summary_file_path = summary_file_path
        self.new_cona = new_cona
        self.columns_to_remove = columns_to_remove or []
        self.df = pd.read_csv(summary_file_path)
        self.allm = self.df.copy(deep=True)

    def process(self):
        if self.new_cona:
            self.remove_columns()
        self.generate_cona_values()

    def remove_columns(self):
        self.allm.drop(columns=self.columns_to_remove, inplace=True, errors='ignore')

    def generate_cona_values(self):
        self.allm['nonbk_u'] = self.allm['pd'] + self.allm['pd_r']

    def generate_cona_file(self, output_path):
        self.allm.to_csv(output_path, index=False)

# Example usage
summary_file_path = 'path/to/summary/file.csv'
output_path = 'path/to/output/cona_file.csv'
columns_to_remove = ['column1', 'column2', 'column3']  # List the columns you want to remove

generator = ConaFileGenerator(summary_file_path, new_cona=True, columns_to_remove=columns_to_remove)
generator.process()
generator.generate_cona_file(output_path)