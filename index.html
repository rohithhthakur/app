import os
import json

def modify_json_files(root_dir):
    # Define the new attribute to add
    new_attribute = {"image_github_url": "https://github.com/example"}

    # Walk through the directory
    for root, dirs, files in os.walk(root_dir):
        for name in files:
            if name == "configuration.json":
                file_path = os.path.join(root, name)
                with open(file_path, 'r') as file:
                    data = json.load(file)
                    
                # Keep only 'names' and 'versions' and modify 'names'
                new_data = {}
                if 'names' in data:
                    new_data['names'] = data['names'].replace('-', '_')
                if 'versions' in data:
                    new_data['versions'] = data['versions']
                
                # Add new attribute
                new_data.update(new_attribute)
                
                # Write the modified data back to the JSON file
                with open(file_path, 'w') as file:
                    json.dump(new_data, file, indent=4)
                
                print(f"Updated {file_path}")

# Specify the path to the directory
root_directory = "/path/to/image-management"
modify_json_files(root_directory)
