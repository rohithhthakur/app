def validate(self, inputs: List[InputObj]) -> List[OutputObj]:
    outputs = []
    name_dataset_map = {}  # Correct initialization

    # Group inputs by name
    for input in inputs:
        name = input.name
        if name not in name_dataset_map:
            name_dataset_map[name] = []
        name_dataset_map[name].append(input)

    # Iterate through each group of datasets by name
    for name, datasets in name_dataset_map.items():
        schema_passed = False
        rules_passed = False
        rules_validation_results_fail = []
        schema_validation_results_total = []

        rules_validation_results_success = []

        # Validate each dataset
        for dataset in datasets:
            data = dataset.value
            dataset_id = dataset.dataset_id
            if data is None or dataset_id is None:
                continue

            # Schema Validation
            schema = self.get_schema(dataset_id)
            schema_validation_results = self.validate_schema(schema, data)
            if schema_validation_results:
                # Collect schema validation errors if any
                message = ' '.join(schema_validation_results)
                schema_validation_results_total.append(OutputObj(False, name + " Schema Validation", message))
            else:
                # Proceed with rules validation if schema validation passes
                schema_passed = True
                rules = self.get_rules(dataset_id)
                rules_validation_results = self.validate_rules(rules, data, name)
                if all(result.result for result in rules_validation_results):
                    rules_passed = True
                    rules_validation_results_success.extend(rules_validation_results)
                    break  # Stop checking other datasets if one passes both schema and rules validation
                elif any(result.result for result in rules_validation_results):
                    rules_validation_results_fail.extend(rules_validation_results)

        # Append results based on validation outcomes
        if schema_passed and rules_passed:
            outputs.extend(rules_validation_results_success)
        else:
            # Append failed rules validation results if schema passed but rules failed
            if schema_passed:
                outputs.extend(rules_validation_results_fail)
            # Append schema validation errors if all datasets failed schema validation
            if not schema_passed:
                outputs.extend(schema_validation_results_total)

    return outputs
    
    
    
    
    ------------------
    def validate(self, inputs: List[InputObj]) -> List[OutputObj]:
    outputs = []
    name_dataset_map = {}  # Group datasets by name

    for input_obj in inputs:
        name = input_obj.name
        name_dataset_map.setdefault(name, []).append(input_obj)

    for name, datasets in name_dataset_map.items():
        schema_passed = False
        for dataset in datasets:
            data = dataset.value
            dataset_id = dataset.dataset_id

            if data is None or dataset_id is None:
                continue

            # Attempt Schema Validation
            schema = self.get_schema(dataset_id)
            schema_validation_results = self.validate_schema(schema, data)
            
            # If schema validation passes, break the loop and proceed to rules validation
            if not schema_validation_results:
                schema_passed = True
                break
            else:
                # Keep track of last schema validation errors in case all fail
                last_schema_errors = schema_validation_results

        # If none of the dataset IDs pass schema validation, append errors
        if not schema_passed and last_schema_errors:
            message = ' '.join(last_schema_errors)
            outputs.append(OutputObj(False, name + " Schema Validation", message))
            continue  # Skip to next name if all dataset_ids for this name failed schema validation
        
        # Perform Rules Validation for the dataset_id that passed schema validation
        rules = self.get_rules(dataset_id)
        rules_validation_results = self.validate_rules(rules, data, name)
        outputs.extend(rules_validation_results)

    return outputs
    
    ---------------/ error
    
    def validate(self, inputs: List[InputObj]) -> List[OutputObj]:
    outputs = []
    name_dataset_map = {}  # Correct initialization

    # Group inputs by name
    for input in inputs:
        name = input.name
        if name not in name_dataset_map:
            name_dataset_map[name] = []
        name_dataset_map[name].append(input)

    # Iterate through each group of datasets by name
    for name, datasets in name_dataset_map.items():
        schema_passed = False
        rules_passed = False
        rules_validation_results_fail = []
        schema_validation_results_total = []

        rules_validation_results_success = []

        # Validate each dataset
        for dataset in datasets:
            data = dataset.value
            dataset_id = dataset.dataset_id
            if data is None or dataset_id is None:
                continue

            # Schema Validation
            schema = self.get_schema(dataset_id)
            schema_validation_results = self.validate_schema(schema, data)
            if schema_validation_results:
                # Collect schema validation errors if any
                message = ' '.join(schema_validation_results)
                schema_validation_results_total.append(OutputObj(False, name + " Schema Validation", message))
            else:
                # Proceed with rules validation if schema validation passes
                schema_passed = True
                try:
                    rules = self.get_rules(dataset_id)
                    rules_validation_results = self.validate_rules(rules, data, name)
                    if all(result.result for result in rules_validation_results):
                        rules_passed = True
                        rules_validation_results_success.extend(rules_validation_results)
                        break  # Stop checking other datasets if one passes both schema and rules validation
                    elif any(result.result for result in rules_validation_results):
                        rules_validation_results_fail.extend(rules_validation_results)
                except Exception as e:
                    print(f"Error during rules validation for dataset '{name}' with ID '{dataset_id}': {e}")
                    # Optionally, you might want to append an error OutputObj to outputs here
                    # outputs.append(OutputObj(False, name + " Rules Validation", f"Error: {e}"))
                    continue  # Move on to the next dataset

        # Append results based on validation outcomes
        if schema_passed and rules_passed:
            outputs.extend(rules_validation_results_success)
        else:
            # Append failed rules validation results if schema passed but rules failed
            if schema_passed:
                outputs.extend(rules_validation_results_fail)
            # Append schema validation errors if all datasets failed schema validation
            if not schema_passed:
                outputs.extend(schema_validation_results_total)

    return outputs
    
    
    