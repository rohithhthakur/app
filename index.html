import pandas as pd

# URLs of your Parquet files in S3
file_path_1 = 's3://your-bucket-name/path/to/your-first-file.parquet'
file_path_2 = 's3://your-bucket-name/path/to/your-second-file.parquet'

# Read the Parquet files
df1 = pd.read_parquet(file_path_1)
df2 = pd.read_parquet(file_path_2)


# Get the schemas as dictionaries
schema1 = {col: str(dtype) for col, dtype in zip(df1.columns, df1.dtypes)}
schema2 = {col: str(dtype) for col, dtype in zip(df2.columns, df2.dtypes)}

# Find differences
differences = {
    'Only in File 1': {k: schema1[k] for k in schema1 if k not in schema2},
    'Only in File 2': {k: schema2[k] for k in schema2 if k not in schema1},
    'Type difference': {k: (schema1[k], schema2[k]) for k in schema1 if k in schema2 and schema1[k] != schema2[k]}
}

print("Differences in Schema:")
for key, value in differences.items():
    if value:
        print(f"{key}:\n{value}\n")